<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>OSAMA vNext ‚Äî IA + –ö–∞—Ç–∞–ª–æ–≥–∏ + –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ñ –ø—Ä–µ–≤ º—é (HTML5 Visual v2)</title>
  <style>
    :root{
      --bg:#f6f1e8;
      --paper:#fffaf2;
      --ink:#111214;
      --muted:#555a63;
      --line:#c9bfae;
      --chip:#efe7db;
      --shadow: 0 10px 34px rgba(17,18,20,.10);
      --radius: 18px;

      --p0:#b42318;
      --p1:#111214;
      --ok:#067647;
      --info:#1d4ed8;
      --warn:#b42318;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1000px 600px at 12% -10%, rgba(17,18,20,.06), transparent 55%),
        radial-gradient(900px 520px at 95% 5%, rgba(17,18,20,.05), transparent 60%),
        var(--bg);
      line-height:1.35;
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1320px;margin:0 auto;padding:22px 18px 90px}

    header{
      background: linear-gradient(180deg, rgba(255,250,242,.95), rgba(255,250,242,.55));
      border:1px solid rgba(17,18,20,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 20px 20px 18px;
      position: relative;
      overflow:hidden;
    }
    header:before{
      content:"";
      position:absolute; inset:-90px -90px auto auto;
      width:280px; height:280px; border-radius:999px;
      background: rgba(17,18,20,.06);
      transform: rotate(18deg);
    }
    .kicker{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      color:var(--muted);
      font-weight:900;
      letter-spacing:.35px;
      font-size:12.5px;
      text-transform: uppercase;
    }
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 10px;border-radius:999px;
      background: rgba(17,18,20,.06);
      border:1px solid rgba(17,18,20,.10);
      font-weight:950;font-size:12px;
    }
    .spark{width:10px;height:10px;border-radius:999px;background:rgba(17,18,20,.32)}
    h1{
      margin:10px 0 8px;
      font-size:38px;
      letter-spacing:-.7px;
      font-weight:950;
    }
    .sub{
      margin:0;
      max-width: 1100px;
      font-size:15.5px;
      color:var(--muted);
    }
    .underline{height:2px;background:var(--line);margin:16px 0 0;width:100%}

    /* Layout */
    .layout{
      display:grid;
      grid-template-columns: 330px 1fr;
      gap:14px;
      margin-top:14px;
      align-items:start;
    }
    @media (max-width: 1100px){
      .layout{grid-template-columns:1fr}
    }

    /* Panels */
    .panel{
      background: rgba(255,250,242,.70);
      border:1px solid rgba(17,18,20,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .ph{
      padding:14px 14px 12px;
      border-bottom:1px solid rgba(17,18,20,.08);
      background: rgba(255,250,242,.78);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      flex-wrap: wrap;
    }
    .ph h2{
      margin:0;
      font-size:15px;
      letter-spacing:-.2px;
      font-weight:950;
    }
    .pb{padding:12px 14px 14px}

    /* Sidebar navigation */
    .nav a{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,255,255,.38);
      margin-bottom:10px;
      font-weight:950;
      color:var(--muted);
    }
    .nav a:hover{background: rgba(17,18,20,.06); color:var(--ink)}
    .nav a.active{background: rgba(17,18,20,.08); color:var(--ink)}
    .tag{
      font-size:11.5px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(17,18,20,.12);
      background: rgba(255,250,242,.88);
      color:var(--muted);
      font-weight:950;
      white-space:nowrap;
    }

    /* Chips & pills */
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{
      padding:7px 10px;border-radius:999px;
      background: var(--chip);
      border: 1px solid rgba(17,18,20,.08);
      font-size:12px;color:var(--muted);
      font-weight:950;
    }
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;border-radius:999px;
      font-weight:950;font-size:12px;
      border:1px solid rgba(17,18,20,.12);
      background: rgba(255,250,242,.85);
      white-space:nowrap;
    }
    .pill.p0{border-color: rgba(180,35,24,.25); background: rgba(180,35,24,.08); color: var(--p0)}
    .pill.p1{border-color: rgba(17,18,20,.18); background: rgba(17,18,20,.06); color: var(--ink)}
    .pill.ok{border-color: rgba(6,118,71,.22); background: rgba(6,118,71,.08); color: var(--ok)}
    .pill.info{border-color: rgba(29,78,216,.18); background: rgba(29,78,216,.06); color: var(--info)}

    .note{
      border-radius: 16px;
      border:1px dashed rgba(17,18,20,.18);
      background: rgba(255,250,242,.80);
      padding:12px 12px;
      color: var(--muted);
      font-size: 13.5px;
    }
    .note b{color:var(--ink)}
    .list{
      margin:10px 0 0;
      padding-left: 18px;
      color: var(--muted);
      font-size: 14px;
    }

    /* Main canvas */
    .canvas{
      background: rgba(255,250,242,.55);
      border:1px solid rgba(17,18,20,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .canvasTop{
      padding:14px 14px 12px;
      border-bottom:1px solid rgba(17,18,20,.08);
      background: rgba(255,250,242,.78);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      flex-wrap:wrap;
    }
    .canvasTop h2{
      margin:0;
      font-size:18px;
      letter-spacing:-.2px;
      font-weight:950;
    }
    .tools{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .btn{
      cursor:pointer;
      user-select:none;
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid rgba(17,18,20,.14);
      background: rgba(255,250,242,.88);
      font-weight:950;
      font-size:12.5px;
      color: var(--ink);
      box-shadow: 0 2px 10px rgba(17,18,20,.06);
      transition: transform .06s ease, background .2s ease;
    }
    .btn:active{transform: translateY(1px)}
    .btn.primary{background: rgba(17,18,20,.08)}
    .btn.ghost{background: rgba(255,255,255,.38)}
    .btn.warn{background: rgba(180,35,24,.10); border-color: rgba(180,35,24,.25); color: var(--warn)}
    .btn.ok{background: rgba(6,118,71,.10); border-color: rgba(6,118,71,.25); color: var(--ok)}

    .canvasBody{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:12px;
      padding:12px 12px 14px;
      align-items:start;
    }
    @media (max-width: 1100px){
      .canvasBody{grid-template-columns:1fr}
    }
    .map, .details{
      border-radius: 16px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,255,255,.45);
      padding: 12px;
      overflow:auto;
    }
    .map{min-height: 720px}
    .details{min-height: 720px}
    .details h3{
      margin:0 0 8px;
      font-size:16px;
      font-weight:950;
      letter-spacing:-.2px;
    }
    .details p{margin:0;color:var(--muted);font-size:14px}
    .sep{height:1px;background:rgba(17,18,20,.08);margin:12px 0}

    /* Tabs inside details */
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .tab{
      cursor:pointer;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(17,18,20,.14);
      background: rgba(255,250,242,.86);
      font-weight:950;font-size:12.5px;color: var(--muted);
    }
    .tab.active{color:var(--ink); background: rgba(17,18,20,.08)}
    .tabPanel{margin-top:10px}
    .hidden{display:none !important}

    /* Tree styles */
    .tree{font-size:14px;color:var(--ink)}
    .node{
      display:flex; align-items:center; gap:10px;
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,250,242,.72);
      margin:8px 0;
      cursor:pointer;
    }
    .node:hover{background: rgba(17,18,20,.06)}
    .node.active{
      outline: 2px solid rgba(17,18,20,.22);
      background: rgba(17,18,20,.08);
    }
    .ico{
      width:34px; height:34px; border-radius: 12px;
      display:grid; place-items:center;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,255,255,.50);
      font-weight:950;
      color:var(--muted);
      flex:0 0 auto;
    }
    .nmeta{display:flex;flex-direction:column;gap:2px;min-width:0}
    .ntitle{
      font-weight:950;
      letter-spacing:-.1px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .nsub{
      color:var(--muted);
      font-size:12.8px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .depth{margin-left: 22px; border-left: 2px solid rgba(17,18,20,.10); padding-left: 12px}

    /* Key/value */
    .grid2{display:grid;grid-template-columns: 1fr 1fr; gap:10px}
    @media (max-width: 1100px){.grid2{grid-template-columns:1fr}}
    .box{
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,250,242,.70);
    }
    .box b{display:block;margin-bottom:4px}
    .box span{color:var(--muted);font-size:13.5px}

    .url{
      font-family: var(--mono);
      font-size: 12px;
      padding:6px 8px;
      border-radius: 12px;
      background: rgba(17,18,20,.06);
      border: 1px solid rgba(17,18,20,.10);
      overflow:auto;
      white-space:nowrap;
    }
    pre{
      margin:0;
      font-family: var(--mono);
      font-size: 12px;
      line-height: 1.45;
      background: rgba(17,18,20,.06);
      border:1px solid rgba(17,18,20,.10);
      border-radius: 14px;
      padding: 10px 10px;
      overflow:auto;
      color:#14161a;
      white-space: pre;
    }

    /* Component preview frames */
    .frames{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    @media (max-width: 1100px){.frames{grid-template-columns:1fr}}
    .frame{
      border-radius: 16px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,255,255,.48);
      overflow:hidden;
    }
    .frameTop{
      display:flex; align-items:center; gap:8px;
      padding:9px 10px;
      background: rgba(17,18,20,.05);
      border-bottom:1px solid rgba(17,18,20,.08);
      color:var(--muted);
      font-weight:950;
      font-size:12px;
    }
    .dots{display:flex;gap:6px;margin-right:4px}
    .dot{width:10px;height:10px;border-radius:999px;background:rgba(17,18,20,.16)}
    .frameBody{padding:10px}
    .phone{
      max-width: 360px;
      margin:0 auto;
      border-radius: 22px;
      border:1px solid rgba(17,18,20,.14);
      background: rgba(255,250,242,.72);
      overflow:hidden;
    }
    .desktop{
      border-radius: 18px;
      border:1px solid rgba(17,18,20,.14);
      background: rgba(255,250,242,.72);
      overflow:hidden;
    }

    /* Wireframe UI atoms */
    .wfHeader{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 10px;
      border-bottom:1px solid rgba(17,18,20,.10);
      background: rgba(255,250,242,.86);
    }
    .wfBrand{font-weight:950}
    .wfPills{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .wfP{padding:6px 8px;border-radius:999px;border:1px solid rgba(17,18,20,.12);background:rgba(255,255,255,.45);font-weight:900;font-size:12px;color:var(--muted)}
    .wfMain{padding:10px; display:grid; gap:10px}
    .wfHero{
      border-radius: 16px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,255,255,.45);
      padding:10px;
    }
    .wfGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .wfCard{
      border-radius: 16px;
      border:1px solid rgba(17,18,20,.10);
      background: rgba(255,255,255,.45);
      padding:10px;
      display:grid;
      gap:6px;
    }
    .wfTitle{font-weight:950; letter-spacing:-.1px}
    .wfMuted{color:var(--muted); font-size:12.8px}
    .wfPrice{font-weight:950}
    .wfBtn{
      margin-top:6px;
      padding:8px 10px;
      border-radius: 14px;
      border:1px solid rgba(17,18,20,.12);
      background: rgba(17,18,20,.06);
      font-weight:950;
      font-size:12.5px;
      color:var(--ink);
      text-align:center;
    }
    .wfAlert{
      border-radius: 16px;
      border-left: 4px solid var(--warn);
      background: rgba(180,35,24,.06);
      padding:10px 10px;
      color:var(--ink);
      border-top:1px solid rgba(17,18,20,.08);
      border-right:1px solid rgba(17,18,20,.08);
      border-bottom:1px solid rgba(17,18,20,.08);
    }
    .wfOk{
      border-left-color: var(--ok);
      background: rgba(6,118,71,.06);
    }
    .wfSkeleton{display:grid; gap:8px}
    .sk{height:12px;border-radius:10px;background: rgba(17,18,20,.10); position:relative; overflow:hidden}
    .sk:after{
      content:""; position:absolute; inset:0;
      transform:translateX(-40%);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.55), transparent);
      animation: shimmer 1.2s infinite;
    }
    @keyframes shimmer{0%{transform:translateX(-70%)}100%{transform:translateX(70%)}}

    .footer{
      margin-top:12px;
      color:var(--muted);
      font-size:12.5px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      opacity:.9;
    }
  </style>
</head>

<body>
<div class="wrap">
  <header>
    <div class="kicker">
      <span class="badge"><span class="spark"></span> HTML5 ‚Ä¢ IA + –ö–∞—Ç–∞–ª–æ–≥–∏ + Preview</span>
      <span>OSAMA vNext</span>
      <span style="opacity:.7">‚Ä¢</span>
      <span>—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç—É ‚Ä¢ –∫–∞—Ç–∞–ª–æ–≥–∏ ‚Ä¢ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏</span>
    </div>
    <h1>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ —Å–∞–π—Ç—É + –ø—Ä–µ–≤ º—é –µ–ª–µ–º–µ–Ω—Ç—ñ–≤</h1>
    <p class="sub">
      –¶–µ –≤—ñ–∑—É–∞–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è: <b>sitemap</b>, <b>–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥—ñ–≤</b>, <b>URL/SEO</b> —Ç–∞ <b>–ø—Ä–µ–≤ º—é –∫–ª—é—á–æ–≤–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤</b>
      (header, mega-menu, category grid, product card, cart, checkout, delivery widget, error states).
      –ù–∞—Ç–∏—Å–Ω–∏ –≤—É–∑–æ–ª –∫–∞—Ä—Ç–∏ ‚Äî –ø—Ä–∞–≤–æ—Ä—É—á –∑‚Äô—è–≤–ª—è—Ç—å—Å—è –¥–µ—Ç–∞–ª—ñ —ñ <b>–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥</b>.
    </p>
    <div class="underline"></div>
  </header>

  <div class="layout">
    <!-- LEFT -->
    <aside class="panel">
      <div class="ph">
        <h2>–ù–∞–≤—ñ–≥–∞—Ü—ñ—è</h2>
        <span class="tag">–≤—ñ–∑—É–∞–ª—å–Ω–∞ IA</span>
      </div>
      <div class="pb">
        <div class="nav" id="sideNav">
          <a href="#ia" class="active" data-jump="ia">–ö–∞—Ä—Ç–∞ —Å–∞–π—Ç—É <span class="tag">Sitemap</span></a>
          <a href="#catalog" data-jump="catalog">–ö–∞—Ç–∞–ª–æ–≥–∏ <span class="tag">Taxonomy</span></a>
          <a href="#urls" data-jump="urls">URL & SEO <span class="tag">Routing</span></a>
          <a href="#templates" data-jump="templates">–®–∞–±–ª–æ–Ω–∏ <span class="tag">SSR/ISR</span></a>
          <a href="#components" data-jump="components">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ <span class="tag">Preview</span></a>
        </div>

        <div class="note">
          <b>–§–æ–∫—É—Å:</b> –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –Ω–∞ –º–µ—Ä–µ–∂—É —Ñ—ñ–ª—ñ–π —ñ –º—ñ—Å—Ç, –±–µ–∑ ‚Äúundefined‚Äù —É meta, –∑ —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—î—é –º–µ–Ω—é (ISR/SSR),
          —Ç–∞ –∑—ñ —Å—Ç—ñ–π–∫–∏–º checkout (fail-state + retry + –∫–æ–Ω—Ç–∞–∫—Ç–∏).
        </div>

        <div class="chips" style="margin-top:12px">
          <span class="chip"><b>SSR</b> –¥–ª—è SEO</span>
          <span class="chip"><b>ISR</b> –¥–ª—è –º–µ–Ω—é</span>
          <span class="chip"><b>BFF</b> —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è</span>
          <span class="chip"><b>Zod</b> –≤–∞–ª—ñ–¥–∞—Ü—ñ—è</span>
        </div>
      </div>
    </aside>

    <!-- RIGHT -->
    <main class="canvas" id="ia">
      <div class="canvasTop">
        <div>
          <div class="pill info">IA</div>
          <h2 style="margin:4px 0 0">–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –∫–∞—Ä—Ç–∞ —Å–∞–π—Ç—É (vNext)</h2>
        </div>
        <div class="tools">
          <button class="btn ghost" id="expandAll">–†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –≤—Å–µ</button>
          <button class="btn ghost" id="collapseAll">–ó–≥–æ—Ä–Ω—É—Ç–∏</button>
          <button class="btn primary" id="focusCatalog">–§–æ–∫—É—Å: –ö–∞—Ç–∞–ª–æ–≥</button>
          <button class="btn primary" id="focusCheckout">–§–æ–∫—É—Å: Checkout</button>
          <button class="btn warn" id="showBad">–ü–æ–∫–∞–∑–∞—Ç–∏ ‚Äú–ø–æ–≥–∞–Ω–æ‚Äù</button>
          <button class="btn ok" id="showGood">–ü–æ–∫–∞–∑–∞—Ç–∏ ‚Äú–ø—ñ—Å–ª—è —Ñ—ñ–∫—Å—É‚Äù</button>
        </div>
      </div>

      <div class="canvasBody">
        <section class="map">
          <div class="pill p1">–í—É–∑–ª–∏ sitemap</div>

          <div class="tree" id="tree">
            <div class="node" data-id="home"><div class="ico">üè†</div><div class="nmeta"><div class="ntitle">–ì–æ–ª–æ–≤–Ω–∞</div><div class="nsub">–ü—Ä–æ–º–æ, –≤–∏–±—ñ—Ä –º—ñ—Å—Ç–∞, –ø–æ–ø—É–ª—è—Ä–Ω–µ –º–µ–Ω—é, CTA</div></div><div class="tag">SSR</div></div>

            <div class="depth" data-children-of="home">
              <div class="node" data-id="chooseCity"><div class="ico">üìç</div><div class="nmeta"><div class="ntitle">–í–∏–±—ñ—Ä –º—ñ—Å—Ç–∞ / —Ñ—ñ–ª—ñ—ó</div><div class="nsub">–°–ø–∏—Å–æ–∫ –º—ñ—Å—Ç, –∞–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è</div></div><div class="tag">SSR</div></div>

              <div class="node" data-id="branchRoot"><div class="ico">üè™</div><div class="nmeta"><div class="ntitle">–§—ñ–ª—ñ—è (–º—ñ—Å—Ç–æ/—Ä–∞–π–æ–Ω)</div><div class="nsub">–•–∞–±: –º–µ–Ω—é, –¥–æ—Å—Ç–∞–≤–∫–∞, –∫–æ–Ω—Ç–∞–∫—Ç–∏</div></div><div class="tag">SSR</div></div>

              <div class="depth" data-children-of="branchRoot">
                <div class="node" data-id="menuRoot"><div class="ico">üç£</div><div class="nmeta"><div class="ntitle">–ú–µ–Ω—é (–∫–∞—Ç–∞–ª–æ–≥)</div><div class="nsub">–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó + ‚Äú–≤—ñ—Ç—Ä–∏–Ω–∏‚Äù (–∞–∫—Ü—ñ—ó/—Ö—ñ—Ç–∏)</div></div><div class="tag">ISR</div></div>

                <div class="depth" data-children-of="menuRoot">
                  <div class="node" data-id="menuCat"><div class="ico">üóÇÔ∏è</div><div class="nmeta"><div class="ntitle">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</div><div class="nsub">Grid + —Ñ—ñ–ª—å—Ç—Ä–∏ + —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è</div></div><div class="tag">ISR</div></div>
                  <div class="node" data-id="product"><div class="ico">üì¶</div><div class="nmeta"><div class="ntitle">–ö–∞—Ä—Ç–∫–∞ —Ç–æ–≤–∞—Ä—É</div><div class="nsub">–°–∫–ª–∞–¥, –∞–ª–µ—Ä–≥–µ–Ω–∏, –≤–∞–≥–∞, upsell</div></div><div class="tag">SSR</div></div>
                  <div class="node" data-id="promoCatalog"><div class="ico">üè∑Ô∏è</div><div class="nmeta"><div class="ntitle">–ü—Ä–æ–º–æ-–≤—ñ—Ç—Ä–∏–Ω–∏</div><div class="nsub">–ê–∫—Ü—ñ—ó ‚Ä¢ –ù–æ–≤–∏–Ω–∫–∏ ‚Ä¢ –•—ñ—Ç–∏ ‚Ä¢ –°–µ–∑–æ–Ω–Ω–µ</div></div><div class="tag">ISR</div></div>
                  <div class="node" data-id="search"><div class="ico">üîé</div><div class="nmeta"><div class="ntitle">–ü–æ—à—É–∫</div><div class="nsub">–ü—ñ–¥–∫–∞–∑–∫–∏, 0-result, rate-limit</div></div><div class="tag">Hybrid</div></div>
                </div>

                <div class="node" data-id="delivery"><div class="ico">üöö</div><div class="nmeta"><div class="ntitle">–î–æ—Å—Ç–∞–≤–∫–∞ —Ç–∞ –æ–ø–ª–∞—Ç–∞</div><div class="nsub">–ó–æ–Ω–∏, —Ç–∞—Ä–∏—Ñ–∏, ETA, –ø—Ä–∞–≤–∏–ª–∞</div></div><div class="tag">SSR</div></div>
                <div class="node" data-id="contacts"><div class="ico">‚òéÔ∏è</div><div class="nmeta"><div class="ntitle">–ö–æ–Ω—Ç–∞–∫—Ç–∏</div><div class="nsub">–¢–µ–ª–µ—Ñ–æ–Ω, —á–∞—Ç, –∫–∞—Ä—Ç–∞, –≥–æ–¥–∏–Ω–∏</div></div><div class="tag">SSR</div></div>
              </div>

              <div class="node" data-id="cart"><div class="ico">üõí</div><div class="nmeta"><div class="ntitle">–ö–æ—à–∏–∫</div><div class="nsub">–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è, –ø—Ä–æ–º–æ–∫–æ–¥, –ø—ñ–¥—Å—É–º–æ–∫</div></div><div class="tag">Client</div></div>
              <div class="node" data-id="checkout"><div class="ico">‚úÖ</div><div class="nmeta"><div class="ntitle">Checkout</div><div class="nsub">–ê–¥—Ä–µ—Å–∞, —á–∞—Å, –æ–ø–ª–∞—Ç–∞, fail-state</div></div><div class="tag">Hybrid</div></div>
              <div class="node" data-id="orderStatus"><div class="ico">üßæ</div><div class="nmeta"><div class="ntitle">–°—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</div><div class="nsub">–¢–∞–π–º–ª–∞–π–Ω, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</div></div><div class="tag">SSR</div></div>
            </div>

            <div class="node" data-id="legal"><div class="ico">üìÑ</div><div class="nmeta"><div class="ntitle">–Æ—Ä–∏–¥–∏—á–Ω—ñ</div><div class="nsub">–ü–æ–ª—ñ—Ç–∏–∫–∞, –æ—Ñ–µ—Ä—Ç–∞, cookies</div></div><div class="tag">SSR</div></div>
          </div>

          <div class="footer">
            <div>–ö–ª—ñ–∫ –Ω–∞ –≤—É–∑–æ–ª ‚Üí –¥–µ—Ç–∞–ª—ñ + –ø—Ä–µ–≤ º—é</div>
            <div><span class="pill p0">P0</span> –ø—Ä–∏–±—Ä–∞—Ç–∏ undefined/–ø–æ—Ä–æ–∂–Ω—ñ —Ü–∏—Ñ—Ä–∏/–≤—ñ—á–Ω–∏–π loading</div>
          </div>
        </section>

        <aside class="details" id="details">
          <div style="display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:center">
            <div class="pill p1" id="dBadge">–í—É–∑–æ–ª</div>
            <div class="tabs" id="detailTabs">
              <button class="tab active" data-tab="spec">–°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è</button>
              <button class="tab" data-tab="preview">–ü—Ä–µ–≤ º—é –µ–ª–µ–º–µ–Ω—Ç—ñ–≤</button>
              <button class="tab" data-tab="states">UI —Å—Ç–∞–Ω–∏</button>
            </div>
          </div>

          <h3 id="dTitle" style="margin-top:10px">–û–±–µ—Ä–∏ –µ–ª–µ–º–µ–Ω—Ç –∫–∞—Ä—Ç–∏</h3>
          <p id="dDesc">–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –≤—É–∑–æ–ª sitemap ‚Äî –ø—Ä–∞–≤–æ—Ä—É—á –±—É–¥—É—Ç—å URL, SEO, SSR/ISR —ñ –ø—Ä–µ–≤ º—é –∫–ª—é—á–æ–≤–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.</p>

          <!-- SPEC -->
          <div class="tabPanel" id="tab-spec">
            <div class="sep"></div>
            <div class="grid2">
              <div class="box"><b>URL-—à–∞–±–ª–æ–Ω</b><div class="url" id="dUrl">‚Äî</div></div>
              <div class="box"><b>–†–µ–Ω–¥–µ—Ä</b><span id="dRender">‚Äî</span></div>
              <div class="box"><b>SEO</b><span id="dSeo">‚Äî</span></div>
              <div class="box"><b>–î–∞–Ω—ñ</b><span id="dData">‚Äî</span></div>
            </div>

            <div class="sep"></div>
            <div class="pill info">–©–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏</div>
            <ul class="list" id="dTodo"></ul>

            <div class="sep"></div>
            <div class="pill p1">Routing/–ù–∞–≤—ñ–≥–∞—Ü—ñ—è</div>
            <pre id="dRoute">‚Äî</pre>
          </div>

          <!-- PREVIEW -->
          <div class="tabPanel hidden" id="tab-preview">
            <div class="sep"></div>
            <div class="pill info">–ü—Ä–µ–≤ º—é (wireframe)</div>
            <p style="margin-top:8px;color:var(--muted);font-size:13.5px">
              –ü–æ–∫–∞–∑—É—î ‚Äú—è–∫ –º–∞—î –≤–∏–≥–ª—è–¥–∞—Ç–∏‚Äù –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏. –ù–µ –¥–∏–∑–∞–π–Ω-–º–∞–∫–µ—Ç, –∞ <b>–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞ –ª–æ–≥—ñ–∫–∞</b>.
            </p>
            <div class="sep"></div>
            <div class="frames">
              <div class="frame">
                <div class="frameTop"><div class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>Desktop preview</div>
                <div class="frameBody">
                  <div class="desktop" id="prevDesktop"></div>
                </div>
              </div>
              <div class="frame">
                <div class="frameTop"><div class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>Mobile preview</div>
                <div class="frameBody">
                  <div class="phone" id="prevMobile"></div>
                </div>
              </div>
            </div>

            <div class="sep"></div>
            <div class="pill p1">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —â–æ –≤—Ö–æ–¥—è—Ç—å</div>
            <div class="chips" id="dComponents"></div>
          </div>

          <!-- STATES -->
          <div class="tabPanel hidden" id="tab-states">
            <div class="sep"></div>
            <div class="pill p0">–ü–æ–≥–∞–Ω–æ (–∞–Ω—Ç–∏–ø–∞—Ç–µ—Ä–Ω)</div>
            <div id="stateBad" style="margin-top:10px"></div>
            <div class="sep"></div>
            <div class="pill ok">–ü—ñ—Å–ª—è —Ñ—ñ–∫—Å—É (–ø—Ä–æ–¥–∞–∫—à–Ω)</div>
            <div id="stateGood" style="margin-top:10px"></div>
            <div class="sep"></div>
            <div class="pill info">–ü—Ä–∞–≤–∏–ª–æ</div>
            <pre id="stateRule">‚Äî</pre>
          </div>
        </aside>
      </div>
    </main>
  </div>

  <!-- Extra sections -->
  <div class="layout" style="margin-top:14px">
    <section class="panel" id="catalog">
      <div class="ph">
        <h2>–ö–∞—Ç–∞–ª–æ–≥–∏ (Taxonomy) ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ</h2>
        <span class="pill info">–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è</span>
      </div>
      <div class="pb">
        <div class="note">
          <b>–ö–æ–Ω—Ü–µ–ø—Ü—ñ—è:</b> ‚Äú–ö–∞—Ç–µ–≥–æ—Ä—ñ—è‚Äù ‚Äî –æ—Å–Ω–æ–≤–Ω–∞ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è –º–µ–Ω—é. ‚Äú–í—ñ—Ç—Ä–∏–Ω–∞‚Äù ‚Äî –Ω–∞–±—ñ—Ä –ø—Ä–∞–≤–∏–ª (–∞–±–æ —Å–ø–∏—Å–æ–∫ id),
          —è–∫–∏–π –ø–æ–∫–∞–∑—É—î —Ç–æ–≤–∞—Ä–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π (–∞–∫—Ü—ñ—ó, —Ö—ñ—Ç–∏, –Ω–æ–≤–∏–Ω–∫–∏). –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–±–∏—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥–∏ –±–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è.
        </div>

        <ul class="list">
          <li><b>Base categories</b>: sets, rolls, sushi, wok, drinks, desserts‚Ä¶</li>
          <li><b>Promo catalogs</b>: hits, new, promo, season, combo, lunch‚Ä¶</li>
          <li><b>Facets</b>: —Ü—ñ–Ω–∞, –≤–∞–≥–∞, –≥–æ—Å—Ç—Ä–æ—Ç–∞, —Å–∫–ª–∞–¥ (—ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç), –∞–ª–µ—Ä–≥–µ–Ω–∏, ‚Äú–±–µ–∑ ‚Ä¶‚Äù (–∑–∞ –ø–æ—Ç—Ä–µ–±–∏)</li>
          <li><b>Landing facets</b> (—ñ–Ω–¥–µ–∫—Å–æ–≤–∞–Ω—ñ): 5‚Äì20 –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π</li>
          <li><b>Long-tail filters</b> (noindex): query params (sort, price range)</li>
        </ul>

        <div class="sep"></div>
        <div class="pill p1">–ü—Ä–∏–∫–ª–∞–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥—ñ–≤</div>
        <pre>/{branch}/menu/sets                 (ISR, index)
 /{branch}/menu/sets/spicy          (ISR, index)  <-- facet-landing (–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π)
 /{branch}/menu/sets?sort=price     (ISR, noindex) <-- long-tail
 /{branch}/promo/hits               (ISR, index)
 /{branch}/promo/new                (ISR, index)</pre>
      </div>
    </section>

    <section class="panel" id="urls">
      <div class="ph">
        <h2>URL & SEO ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ</h2>
        <span class="pill p0">P0: –±–µ–∑ undefined</span>
      </div>
      <div class="pb">
        <div class="grid2">
          <div class="box"><b>–§—ñ–ª—ñ—è</b><span class="url">/{branchSlug}</span></div>
          <div class="box"><b>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</b><span class="url">/{branchSlug}/menu/{categorySlug}</span></div>
          <div class="box"><b>–¢–æ–≤–∞—Ä</b><span class="url">/{branchSlug}/p/{productSlug}-{id}</span></div>
          <div class="box"><b>–ü—Ä–æ–º–æ</b><span class="url">/{branchSlug}/promo/{promoSlug}</span></div>
        </div>
        <div class="sep"></div>
        <div class="note"><b>Middleware:</b> branchSlug –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –Ω–∞ edge. –ù–µ–≤—ñ–¥–æ–º–∏–π slug ‚Üí redirect –Ω–∞ /choose-city –∞–±–æ 404.
          –¶–µ —É—Å—É–≤–∞—î –±–∞–≥–∏ —Ç–∏–ø—É ‚Äúundefined —É title/meta‚Äù.
        </div>
      </div>
    </section>
  </div>

  <div class="layout" style="margin-top:14px">
    <section class="panel" id="templates">
      <div class="ph">
        <h2>–®–∞–±–ª–æ–Ω–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫</h2>
        <span class="pill ok">—à–≤–∏–¥–∫—ñ—Å—Ç—å + SEO</span>
      </div>
      <div class="pb">
        <ul class="list">
          <li><b>SSR</b>: /{branch}, /delivery, /contacts, /p/*, /order/*</li>
          <li><b>ISR</b>: /menu/*, /promo/* (revalidate 60‚Äì120—Å)</li>
          <li><b>Client</b>: /cart</li>
          <li><b>Hybrid</b>: /checkout (SSR –∫–∞—Ä–∫–∞—Å + client –ª–æ–≥—ñ–∫–∞)</li>
        </ul>
        <div class="sep"></div>
        <div class="pill info">–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω—ñ UI —Å—Ç–∞–Ω–∏</div>
        <pre>loading: skeleton + —Ç–∞–π–º–∞—É—Ç
error: –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è + retry + –∫–æ–Ω—Ç–∞–∫—Ç–∏ (—Ç–µ–ª–µ—Ñ–æ–Ω/—á–∞—Ç)
empty: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó (–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó/—Ö—ñ—Ç–∏)
offline/degraded: –∫–µ—à (stale) + –ø–æ–∑–Ω–∞—á–∫–∞ ‚Äú–æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è‚Äù</pre>
      </div>
    </section>

    <section class="panel" id="components">
      <div class="ph">
        <h2>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ (Preview library)</h2>
        <span class="pill info">UI kit</span>
      </div>
      <div class="pb">
        <div class="note">
          <b>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:</b> –∑–±–∏—Ä–∞—î–º–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏—Ö –±–ª–æ–∫—ñ–≤ (Header, CityPicker, CategoryGrid, ProductCard, CartDrawer, CheckoutForm‚Ä¶).
          –¢–∞–∫ –ø—Ä–æ—Å—Ç—ñ—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —è–∫—ñ—Å—Ç—å —ñ –Ω–µ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ ‚Äú–ø–æ—Ä–æ–∂–Ω—ñ —Ü–∏—Ñ—Ä–∏/undefined‚Äù.
        </div>
        <div class="sep"></div>
        <div class="chips">
          <span class="chip">Header + City switcher</span>
          <span class="chip">MegaMenu</span>
          <span class="chip">CategoryGrid</span>
          <span class="chip">ProductCard</span>
          <span class="chip">DeliveryWidget</span>
          <span class="chip">CartDrawer</span>
          <span class="chip">CheckoutForm</span>
          <span class="chip">ErrorBanner</span>
        </div>
      </div>
    </section>
  </div>

  <div class="footer" style="margin-top:14px">
    <div>OSAMA vNext ‚Ä¢ IA + Catalog + Preview (HTML5 v2)</div>
    <div>–§–∞–π–ª –º–æ–∂–Ω–∞ –ø–æ–∫–ª–∞—Å—Ç–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —è–∫ <span class="url">/docs/osama-ia-preview.html</span></div>
  </div>
</div>

<script>
  // --------- Content model ----------
  const previews = {
    home: {
      desktop: () => pageHome(false),
      mobile: () => pageHome(true),
      components: ["Header", "CityPicker", "PromoStrip", "CategoryShortcuts", "HitsCarousel"],
      bad: () => stateLoadingForever("–ì–æ–ª–æ–≤–Ω–∞: –ø–æ—Ä–æ–∂–Ω—ñ–π –ø–µ—Ä—à–∏–π –µ–∫—Ä–∞–Ω (CSR)"),
      good: () => stateOk("–ì–æ–ª–æ–≤–Ω–∞: SSR –∫–æ–Ω—Ç–µ–Ω—Ç + —à–≤–∏–¥–∫—ñ CTA"),
      rule: "–ü–µ—Ä—à–∏–π –µ–∫—Ä–∞–Ω (Above-the-fold) ‚Äî —Ç—ñ–ª—å–∫–∏ SSR/ISR. –ù—ñ—è–∫–∏—Ö '–ø–æ—Ä–æ–∂–Ω—ñ—Ö' –∑–∞–≥–ª—É—à–æ–∫ –±–µ–∑ —Ç–∞–π–º–∞—É—Ç—É."
    },
    chooseCity: {
      desktop: () => pageChooseCity(false),
      mobile: () => pageChooseCity(true),
      components: ["Header", "CitySearch", "CityList", "AutoDetectHint"],
      bad: () => stateBadUndefined("–ù–µ–≤—ñ–¥–æ–º–∏–π slug ‚Üí undefined —É title"),
      good: () => stateOk("–ù–µ–≤—ñ–¥–æ–º–∏–π slug ‚Üí redirect –Ω–∞ –≤–∏–±—ñ—Ä –º—ñ—Å—Ç–∞/404"),
      rule: "branchSlug –≤–∞–ª—ñ–¥–æ–≤–∞–Ω–∏–π –Ω–∞ edge. Meta –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –∑ –≤–∞–ª—ñ–¥–Ω–æ–≥–æ BranchConfig."
    },
    branchRoot: {
      desktop: () => pageBranch(false),
      mobile: () => pageBranch(true),
      components: ["Header", "BranchHero", "QuickLinks", "DeliveryWidget", "ContactsCard"],
      bad: () => stateBadUndefined("Title –º—ñ—Å—Ç–∏—Ç—å 'undefined'"),
      good: () => stateOk("Title –º—ñ—Å—Ç–∏—Ç—å –Ω–∞–∑–≤—É –º—ñ—Å—Ç–∞/—Ñ—ñ–ª—ñ—ó"),
      rule: "generateMetadata() –ø—Ä–∞—Ü—é—î –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ: —è–∫—â–æ –∫–æ–Ω—Ñ—ñ–≥ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π ‚Äî noindex/redirect."
    },
    menuRoot: {
      desktop: () => pageMenuIndex(false),
      mobile: () => pageMenuIndex(true),
      components: ["Header", "MegaMenu", "CategoryTiles", "PromoCatalogTiles", "SearchBar"],
      bad: () => stateLoadingForever("–ú–µ–Ω—é: —Ç–æ–≤–∞—Ä–∏ —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è JS"),
      good: () => stateOk("–ú–µ–Ω—é: ISR (revalidate 60‚Äì120—Å) + –∫–µ—à"),
      rule: "–ú–µ–Ω—é —Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó: ISR/SSR, –∞ –Ω–µ —á–∏—Å—Ç–∏–π CSR. Error boundary + 'serve stale' –ø—Ä–∏ –∑–±–æ—è—Ö."
    },
    menuCat: {
      desktop: () => pageCategory(false),
      mobile: () => pageCategory(true),
      components: ["Header", "Breadcrumbs", "FacetBar", "CategoryGrid", "ProductCard"],
      bad: () => stateLoadingForever("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: –≤—ñ—á–Ω–∏–π Loading –ø—Ä–∏ –ø–∞–¥—ñ–Ω–Ω—ñ API"),
      good: () => stateOk("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: skeleton + timeout + retry + fallback"),
      rule: "–ë—É–¥—å-—è–∫–∏–π loading –º–∞—î timeout —ñ —à–ª—è—Ö –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è: retry + –∫–æ–Ω—Ç–∞–∫—Ç–∏."
    },
    product: {
      desktop: () => pageProduct(false),
      mobile: () => pageProduct(true),
      components: ["Header", "Breadcrumbs", "ProductGallery", "Ingredients", "Allergens", "AddToCart", "Upsell"],
      bad: () => stateBadEmptyNumbers("–¢–æ–≤–∞—Ä: —Ü—ñ–Ω–∞/–≤–∞–≥–∞ –ø–æ—Ä–æ–∂–Ω—ñ"),
      good: () => stateOk("–¢–æ–≤–∞—Ä: –≤–∞–ª—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ 404"),
      rule: "Runtime-–≤–∞–ª–∏–¥–∞—Ü—ñ—è (Zod). –ù–µ–≤–∞–ª—ñ–¥–Ω–µ ‚Üí 404/—Ñ–æ–ª–±–µ–∫, –∞–ª–µ –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ –ø–æ–ª—è."
    },
    promoCatalog: {
      desktop: () => pagePromo(false),
      mobile: () => pagePromo(true),
      components: ["Header", "PromoHero", "Grid", "Badges"],
      bad: () => stateLoadingForever("–ü—Ä–æ–º–æ: –Ω–µ–º–∞—î –∫–µ—à—É ‚Üí –ø–æ–≤—ñ–ª—å–Ω–æ"),
      good: () => stateOk("–ü—Ä–æ–º–æ: ISR + on-demand revalidate (—è–∫—â–æ –º–æ–∂–Ω–∞)"),
      rule: "–í—ñ—Ç—Ä–∏–Ω–∏ ‚Äî ISR. –î–∞–Ω—ñ —Å—Ç–∞–±—ñ–ª—ñ–∑—É—é—Ç—å—Å—è BFF (timeout/retry/cache)."
    },
    search: {
      desktop: () => pageSearch(false),
      mobile: () => pageSearch(true),
      components: ["Header", "SearchInput", "Suggestions", "Results", "EmptyState"],
      bad: () => stateLoadingForever("–ü–æ—à—É–∫: –∑–∞–≤–∏—Å–∞–Ω–Ω—è –±–µ–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"),
      good: () => stateOk("–ü–æ—à—É–∫: SSR —Ä–µ–∑—É–ª—å—Ç–∞—Ç + client –ø—ñ–¥–∫–∞–∑–∫–∏ + rate-limit"),
      rule: "–ü–æ—à—É–∫: noindex, –∞–ª–µ UX —à–≤–∏–¥–∫–∏–π. 0-result –º–∞—î —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó."
    },
    delivery: {
      desktop: () => pageDelivery(false),
      mobile: () => pageDelivery(true),
      components: ["Header", "DeliveryWidget", "Zones", "PaymentInfo", "FAQ"],
      bad: () => stateBadEmptyNumbers("Delivery: '–í–∞—Ä—Ç—ñ—Å—Ç—å ‚Äî  –≥—Ä–Ω'"),
      good: () => stateOk("Delivery: —Ü–∏—Ñ—Ä–∏ –∞–±–æ —á–µ—Å–Ω–∏–π —Ñ–æ–ª–±–µ–∫ + –ª–æ–≥/–∞–ª–µ—Ä—Ç"),
      rule: "–ù–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç–∏ —à–∞–±–ª–æ–Ω –∑ null/NaN. –ö—Ä–∞—â–µ —Ñ–æ–ª–±–µ–∫ —Ç–µ–∫—Å—Ç + –∫–æ–Ω—Ç–∞–∫—Ç–∏."
    },
    contacts: {
      desktop: () => pageContacts(false),
      mobile: () => pageContacts(true),
      components: ["Header", "Phones", "ChatCTA", "MapCard", "Hours"],
      bad: () => stateLoadingForever("–ö–æ–Ω—Ç–∞–∫—Ç–∏: –Ω–µ –≤–∏–¥–Ω–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –Ω–∞ checkout"),
      good: () => stateOk("–ö–æ–Ω—Ç–∞–∫—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑ checkout —è–∫ '—Ä—è—Ç—ñ–≤–Ω–∏–π –≤–∏—Ö—ñ–¥'"),
      rule: "–ù–∞ checkout –∑–∞–≤–∂–¥–∏ —î –∫–æ–Ω—Ç–∞–∫—Ç–∏: —Ç–µ–ª–µ—Ñ–æ–Ω/—á–∞—Ç –ø–æ—Ä—É—á."
    },
    cart: {
      desktop: () => pageCart(false),
      mobile: () => pageCart(true),
      components: ["CartDrawer", "LineItems", "PromoCode", "Totals", "CTA Checkout"],
      bad: () => stateLoadingForever("–ö–æ—à–∏–∫: –∑–Ω–∏–∫ –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è"),
      good: () => stateOk("–ö–æ—à–∏–∫: –ª–æ–∫–∞–ª—å–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è + server quote"),
      rule: "Cart state –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. Server quote –º–∞—î timeout/retry."
    },
    checkout: {
      desktop: () => pageCheckout(false),
      mobile: () => pageCheckout(true),
      components: ["CheckoutForm", "Address", "TimeSlot", "Payment", "OrderSummary", "ErrorBanner", "ContactsCTA"],
      bad: () => stateLoadingForever("Checkout: –≤—ñ—á–Ω–∏–π Loading (–Ω–µ–º–∞ fail-state)"),
      good: () => stateOk("Checkout: state machine + retry + –∫–æ–Ω—Ç–∞–∫—Ç–∏"),
      rule: "Checkout: loading/error/retry/offline ‚Äî –æ–±–æ–≤'—è–∑–∫–æ–≤–æ. Idempotency key –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è."
    },
    orderStatus: {
      desktop: () => pageOrder(false),
      mobile: () => pageOrder(true),
      components: ["OrderTimeline", "SupportCTA"],
      bad: () => stateBadUndefined("–°—Ç–∞—Ç—É—Å: PII —É URL –±–µ–∑ —Ç–æ–∫–µ–Ω–∞"),
      good: () => stateOk("–°—Ç–∞—Ç—É—Å: tokenized URL + noindex"),
      rule: "PII –Ω–µ –≤ URL, —Ç—ñ–ª—å–∫–∏ —Ç–æ–∫–µ–Ω–∏. noindex –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏."
    },
    legal: {
      desktop: () => pageLegal(false),
      mobile: () => pageLegal(true),
      components: ["LegalNav", "Content"],
      bad: () => stateLoadingForever("Legal: –≤–∞–∂–∫–æ –∑–Ω–∞–π—Ç–∏ cookies/–æ—Ñ–µ—Ä—Ç—É"),
      good: () => stateOk("Legal: –∑—Ä–æ–∑—É–º—ñ–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑ footer"),
      rule: "–Æ—Ä–∏–¥–∏—á–Ω—ñ ‚Äî —Å—Ç–∞—Ç–∏—á–Ω—ñ SSR —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ —á—ñ—Ç–∫–∏–º–∏ —à–ª—è—Ö–∞–º–∏ —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º –∫–æ–Ω—Ç–µ–Ω—Ç—É."
    },
  };

  const meta = {
    home:        { url:"/", render:"SSR", seo:"OG/Title –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, —à–≤–∏–¥–∫–∏–π –ø–µ—Ä—à–∏–π –µ–∫—Ä–∞–Ω", data:"promo + hits (–∫–µ—à)", todo:["SSR –¥–ª—è hero/–ø—Ä–æ–º–æ","–í–∏–±—ñ—Ä –º—ñ—Å—Ç–∞","–•—ñ—Ç–∏/–ù–æ–≤–∏–Ω–∫–∏ —è–∫ –∫–∞—Ç–∞–ª–æ–≥–∏"], route:"app/page.tsx (SSR)"},
    chooseCity:  { url:"/choose-city", render:"SSR", seo:"noindex, UX-—Å–µ—Ä–≤—ñ—Å", data:"branch list (source of truth)", todo:["–†–µ–¥–∏—Ä–µ–∫—Ç unknown slug","Cookie –≤–∏–±–æ—Ä—É —Ñ—ñ–ª—ñ—ó","–ü–æ—à—É–∫ –ø–æ –º—ñ—Å—Ç–∞—Ö"], route:"middleware redirect + SSR"},
    branchRoot:  { url:"/{branchSlug}", render:"SSR", seo:"–ª–æ–∫–∞–ª—å–Ω–∞ SEO —Å—Ç–æ—Ä—ñ–Ω–∫–∞, canonical/OG", data:"BranchConfig (–≤–∞–ª–∏–¥–∞—Ü—ñ—è)", todo:["generateMetadata –∑ –≤–∞–ª—ñ–¥–Ω–æ–≥–æ cfg","404/redirect –ø—Ä–∏ unknown slug","DeliveryWidget –∑ —Ü–∏—Ñ—Ä–∞–º–∏"], route:"app/[branchSlug]/page.tsx"},
    menuRoot:    { url:"/{branchSlug}/menu", render:"ISR", seo:"HTML –º—ñ—Å—Ç–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó/—Ç–æ–≤–∞—Ä–∏", data:"MenuIndex (–∫–µ—à)", todo:["ISR revalidate 60‚Äì120—Å","Error boundary","Serve stale"], route:"app/[branch]/menu/page.tsx"},
    menuCat:     { url:"/{branchSlug}/menu/{categorySlug}", render:"ISR", seo:"canonical + noindex –¥–ª—è long-tail", data:"MenuCategory + facets", todo:["FacetBar","Skeleton+timeout","Retry+fallback"], route:"app/[branch]/menu/[cat]/page.tsx"},
    product:     { url:"/{branchSlug}/p/{productSlug}-{id}", render:"SSR", seo:"OG + Structured data (–æ–ø—Ü—ñ–π–Ω–æ)", data:"MenuItem", todo:["Zod validation","404 —è–∫—â–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω–æ","Upsell"], route:"app/[branch]/p/[slugId]/page.tsx"},
    promoCatalog:{ url:"/{branchSlug}/promo/{promoSlug}", render:"ISR", seo:"–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π slug, index", data:"PromoCatalog", todo:["PromoCatalog entity","ISR + on-demand revalidate","Canonical"], route:"app/[branch]/promo/[promo]/page.tsx"},
    search:      { url:"/{branchSlug}/search?q=...", render:"Hybrid", seo:"noindex, —à–≤–∏–¥–∫–∏–π UX", data:"search + suggest", todo:["SSR results","client suggestions","rate-limit"], route:"/search SSR + /api/suggest"},
    delivery:    { url:"/{branchSlug}/delivery", render:"SSR", seo:"–ª–æ–∫–∞–ª—å–Ω—ñ —É–º–æ–≤–∏, –∫–æ–Ω–≤–µ—Ä—Å—ñ—è", data:"DeliveryCfg", todo:["–¶–∏—Ñ—Ä–∏ –∞–±–æ —Ñ–æ–ª–±–µ–∫","Zod validation","Alerts –Ω–∞ null/NaN"], route:"SSR fetch + validate"},
    contacts:    { url:"/{branchSlug}/contacts", render:"SSR", seo:"–ª–æ–∫–∞–ª—å–Ω–∞ –¥–æ–≤—ñ—Ä–∞", data:"phones/hours/map", todo:["–ö–æ–Ω—Ç–∞–∫—Ç–∏ –≤ checkout","CTA –¥–∑–≤—ñ–Ω–æ–∫/—á–∞—Ç","Hours"], route:"SSR BranchConfig"},
    cart:        { url:"/cart", render:"Client", seo:"noindex", data:"local cart + quote", todo:["Persist cart","Quote timeout/retry","Empty state"], route:"client state"},
    checkout:    { url:"/checkout", render:"Hybrid", seo:"noindex, –∞–ª–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó", data:"checkout session", todo:["State machine","Idempotency key","Retry/contacts"], route:"SSR shell + client form"},
    orderStatus: { url:"/order/{token}", render:"SSR", seo:"noindex + token", data:"order status", todo:["Tokenized URL","Support CTA","Auto-refresh"], route:"SSR fetch by token"},
    legal:       { url:"/legal/*", render:"SSR", seo:"–æ–∫", data:"static content", todo:["–ó—Ä–æ–∑—É–º—ñ–ª–∏–π nav","Footer links","Update content"], route:"SSR static"},
  };

  // --------- Wireframe builders ----------
  function wfHeader(titleRight){
    return `
      <div class="wfHeader">
        <div class="wfBrand">OSAMA</div>
        <div class="wfPills">
          <div class="wfP">–ú—ñ—Å—Ç–æ ‚ñº</div>
          <div class="wfP">–ú–µ–Ω—é</div>
          <div class="wfP">–ê–∫—Ü—ñ—ó</div>
          <div class="wfP">–î–æ—Å—Ç–∞–≤–∫–∞</div>
          <div class="wfP">–ö–æ–Ω—Ç–∞–∫—Ç–∏</div>
          <div class="wfP">${titleRight || "–ö–æ—à–∏–∫ (2)"}</div>
        </div>
      </div>`;
  }
  function wfHero(title, subtitle){
    return `
      <div class="wfHero">
        <div class="wfTitle">${title}</div>
        <div class="wfMuted" style="margin-top:4px">${subtitle}</div>
        <div class="wfBtn">CTA: –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é</div>
      </div>`;
  }
  function wfCard(title, sub, price){
    return `
      <div class="wfCard">
        <div class="wfTitle">${title}</div>
        <div class="wfMuted">${sub}</div>
        <div class="wfPrice">${price}</div>
        <div class="wfBtn">–î–æ–¥–∞—Ç–∏</div>
      </div>`;
  }
  function wfCategoryGrid(){
    return `
      <div class="wfGrid">
        ${wfCard("–°–µ—Ç ‚ÄúKyiv Mix‚Äù","32 —à—Ç ‚Ä¢ 920 –≥","529 –≥—Ä–Ω")}
        ${wfCard("–°–µ—Ç ‚ÄúClassic‚Äù","24 —à—Ç ‚Ä¢ 680 –≥","399 –≥—Ä–Ω")}
        ${wfCard("–°–µ—Ç ‚ÄúFamily‚Äù","40 —à—Ç ‚Ä¢ 1.2 –∫–≥","699 –≥—Ä–Ω")}
        ${wfCard("–°–µ—Ç ‚ÄúLight‚Äù","20 —à—Ç ‚Ä¢ 560 –≥","349 –≥—Ä–Ω")}
      </div>`;
  }
  function wfFacetBar(){
    return `
      <div class="wfHero" style="padding:10px">
        <div class="wfTitle">–§—ñ–ª—å—Ç—Ä–∏</div>
        <div class="wfPills" style="margin-top:8px">
          <div class="wfP">—Ü—ñ–Ω–∞</div><div class="wfP">–≤–∞–≥–∞</div><div class="wfP">–≥–æ—Å—Ç—Ä–µ</div><div class="wfP">–∞–ª–µ—Ä–≥–µ–Ω–∏</div><div class="wfP">sort ‚ñº</div>
        </div>
      </div>`;
  }
  function wfDeliveryWidget(ok=true){
    if(ok){
      return `<div class="wfAlert wfOk"><b>–î–æ—Å—Ç–∞–≤–∫–∞:</b> 49 –≥—Ä–Ω ‚Ä¢ <b>–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ –≤—ñ–¥:</b> 499 –≥—Ä–Ω ‚Ä¢ <b>ETA:</b> 45‚Äì90 —Ö–≤</div>`;
    }
    return `<div class="wfAlert"><b>–î–æ—Å—Ç–∞–≤–∫–∞:</b>  –≥—Ä–Ω ‚Ä¢ <b>–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ –≤—ñ–¥:</b>  –≥—Ä–Ω ‚Ä¢ <b>ETA:</b> –∑ -</div>`;
  }
  function wfCartDrawer(ok=true){
    const header = `<div class="wfHeader"><div class="wfBrand">–ö–æ—à–∏–∫</div><div class="wfP">–ó–∞–∫—Ä–∏—Ç–∏ ‚úï</div></div>`;
    if(!ok){
      return `${header}<div class="wfMain"><div class="wfAlert">–ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∫–æ—à–∏–∫ –∑–Ω–∏–∫ (–Ω–µ–º–∞ persist)</div></div>`;
    }
    return `${header}<div class="wfMain">
      ${wfCard("–°–µ—Ç ‚ÄúKyiv Mix‚Äù","1√ó ‚Ä¢ 529 –≥—Ä–Ω","–ü—Ä–æ–º—ñ–∂–Ω–∏–π –ø—ñ–¥—Å—É–º–æ–∫")}
      <div class="wfHero"><div class="wfTitle">–†–∞–∑–æ–º: 529 –≥—Ä–Ω</div><div class="wfMuted">–î–æ—Å—Ç–∞–≤–∫–∞ –∑–∞ —É–º–æ–≤–∞–º–∏ —Ñ—ñ–ª—ñ—ó</div><div class="wfBtn">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ Checkout</div></div>
    </div>`;
  }
  function wfCheckout(ok=true){
    const header = `<div class="wfHeader"><div class="wfBrand">Checkout</div><div class="wfP">–ö–æ–Ω—Ç–∞–∫—Ç–∏</div></div>`;
    if(!ok){
      return `${header}<div class="wfMain"><div class="wfAlert">Loading‚Ä¶ (–Ω–µ–º–∞ fail-state)</div><div class="wfSkeleton">
        <div class="sk" style="width:80%"></div><div class="sk" style="width:95%"></div><div class="sk" style="width:88%"></div>
      </div></div>`;
    }
    return `${header}<div class="wfMain">
      <div class="wfHero"><div class="wfTitle">1) –ê–¥—Ä–µ—Å–∞</div><div class="wfMuted">–ü–æ–ª–µ –∞–¥—Ä–µ—Å–∏ + –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–æ–Ω–∏</div></div>
      <div class="wfHero"><div class="wfTitle">2) –ß–∞—Å</div><div class="wfMuted">–í–∏–±—ñ—Ä —Å–ª–æ—Ç–∞ / ASAP</div></div>
      <div class="wfHero"><div class="wfTitle">3) –û–ø–ª–∞—Ç–∞</div><div class="wfMuted">–ö–∞—Ä—Ç–∫–∞/–≥–æ—Ç—ñ–≤–∫–∞/–æ–Ω–ª–∞–π–Ω</div></div>
      <div class="wfAlert wfOk"><b>–°—Ç–∞–Ω:</b> –≤—Å–µ –æ–∫. –Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç–∏ Retry + —Ç–µ–ª–µ—Ñ–æ–Ω/—á–∞—Ç.</div>
      <div class="wfBtn">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</div>
    </div>`;
  }
  function wfMetaBad(){
    return `<div class="wfAlert"><b>&lt;title&gt;</b>: –î–æ—Å—Ç–∞–≤–∫–∞ —Å—É—à—ñ –≤ <b>undefined</b> ‚Ä¢ OSAMA</div>`;
  }
  function wfMetaGood(city="–û–±—É—Ö–æ–≤—ñ"){
    return `<div class="wfAlert wfOk"><b>&lt;title&gt;</b>: –î–æ—Å—Ç–∞–≤–∫–∞ —Å—É—à—ñ –≤ <b>${city}</b> ‚Ä¢ OSAMA</div>`;
  }
  function wfLoadingBlock(label){
    return `<div class="wfAlert"><b>${label}</b>: <span style="opacity:.75">Loading‚Ä¶</span></div>
      <div class="wfSkeleton" style="margin-top:10px">
        <div class="sk" style="width:68%"></div>
        <div class="sk" style="width:92%"></div>
        <div class="sk" style="width:78%"></div>
        <div class="sk" style="width:55%"></div>
      </div>`;
  }

  // Pages
  function pageHome(isMobile){
    return `
      ${wfHeader()}
      <div class="wfMain">
        ${wfHero("OSAMA ‚Ä¢ —à–≤–∏–¥–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∞","–û–±–µ—Ä–∏ –º—ñ—Å—Ç–æ ‚Äî —ñ –ø–µ—Ä–µ—Ö–æ–¥—å –≤ –º–µ–Ω—é")}
        ${wfHero("–•—ñ—Ç–∏ —Ç–∏–∂–Ω—è","–ö–∞—Ç–∞–ª–æ–≥ /promo/hits (ISR)")}
        ${isMobile ? wfCategoryGrid().replace('wfGrid','wfGrid') : wfCategoryGrid()}
      </div>`;
  }
  function pageChooseCity(isMobile){
    return `
      ${wfHeader("–ü–æ—à—É–∫")}
      <div class="wfMain">
        ${wfHero("–í–∏–±–µ—Ä—ñ—Ç—å –º—ñ—Å—Ç–æ","–ê–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç + —Å–ø–∏—Å–æ–∫ —Ñ—ñ–ª—ñ–π")}
        <div class="wfHero"><div class="wfTitle">–°–ø–∏—Å–æ–∫ —Ñ—ñ–ª—ñ–π</div><div class="wfMuted">–ö–∏—ó–≤ ‚Ä¢ –û–±—É—Ö—ñ–≤ ‚Ä¢ ‚Ä¶</div><div class="wfBtn">–û–±—Ä–∞—Ç–∏</div></div>
        ${isMobile ? "" : `<div class="wfHero"><div class="wfTitle">–ü–æ—Ä–∞–¥–∞</div><div class="wfMuted">–ù–µ–≤—ñ–¥–æ–º–∏–π slug ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å—é–¥–∏ (edge)</div></div>`}
      </div>`;
  }
  function pageBranch(isMobile){
    return `
      ${wfHeader("–ú–µ–Ω—é")}
      <div class="wfMain">
        ${wfHero("–§—ñ–ª—ñ—è: –ö–∏—ó–≤ (–ë–∞–∂–∞–Ω–∞)","–ì–æ–¥–∏–Ω–∏ ‚Ä¢ —Ç–µ–ª–µ—Ñ–æ–Ω ‚Ä¢ –∫–∞—Ä—Ç–∞")}
        ${wfDeliveryWidget(true)}
        <div class="wfGrid">
          <div class="wfCard"><div class="wfTitle">–ú–µ–Ω—é</div><div class="wfMuted">–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó + –≤—ñ—Ç—Ä–∏–Ω–∏</div><div class="wfBtn">–í—ñ–¥–∫—Ä–∏—Ç–∏</div></div>
          <div class="wfCard"><div class="wfTitle">–ö–æ–Ω—Ç–∞–∫—Ç–∏</div><div class="wfMuted">–¢–µ–ª–µ—Ñ–æ–Ω/—á–∞—Ç</div><div class="wfBtn">–ó–∞—Ç–µ–ª–µ—Ñ–æ–Ω—É–≤–∞—Ç–∏</div></div>
        </div>
      </div>`;
  }
  function pageMenuIndex(isMobile){
    return `
      ${wfHeader("–ü–æ—à—É–∫")}
      <div class="wfMain">
        ${wfHero("–ú–µ–Ω—é","–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó (ISR) + –ø—Ä–æ–º–æ-–≤—ñ—Ç—Ä–∏–Ω–∏")}
        <div class="wfGrid">
          <div class="wfCard"><div class="wfTitle">–°–µ—Ç–∏</div><div class="wfMuted">/{branch}/menu/sets</div><div class="wfBtn">–í—ñ–¥–∫—Ä–∏—Ç–∏</div></div>
          <div class="wfCard"><div class="wfTitle">–†–æ–ª–∏</div><div class="wfMuted">/{branch}/menu/rolls</div><div class="wfBtn">–í—ñ–¥–∫—Ä–∏—Ç–∏</div></div>
          <div class="wfCard"><div class="wfTitle">–•—ñ—Ç–∏</div><div class="wfMuted">/{branch}/promo/hits</div><div class="wfBtn">–í—ñ–¥–∫—Ä–∏—Ç–∏</div></div>
          <div class="wfCard"><div class="wfTitle">–ù–æ–≤–∏–Ω–∫–∏</div><div class="wfMuted">/{branch}/promo/new</div><div class="wfBtn">–í—ñ–¥–∫—Ä–∏—Ç–∏</div></div>
        </div>
      </div>`;
  }
  function pageCategory(isMobile){
    return `
      ${wfHeader("–ö–æ—à–∏–∫ (2)")}
      <div class="wfMain">
        ${wfHero("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: –°–µ—Ç–∏","Breadcrumbs: –ì–æ–ª–æ–≤–Ω–∞ ‚Üí –ú–µ–Ω—é ‚Üí –°–µ—Ç–∏")}
        ${wfFacetBar()}
        ${wfCategoryGrid()}
      </div>`;
  }
  function pageProduct(isMobile){
    return `
      ${wfHeader("–ö–æ—à–∏–∫ (2)")}
      <div class="wfMain">
        ${wfHero("–°–µ—Ç ‚ÄúKyiv Mix‚Äù","–§–æ—Ç–æ ‚Ä¢ –≤–∞–≥–∞ ‚Ä¢ —Å–∫–ª–∞–¥ ‚Ä¢ –∞–ª–µ—Ä–≥–µ–Ω–∏")}
        <div class="wfGrid">
          <div class="wfCard"><div class="wfTitle">–°–∫–ª–∞–¥</div><div class="wfMuted">–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏, –∞–ª–µ—Ä–≥–µ–Ω–∏</div><div class="wfBtn">–î–µ—Ç–∞–ª—ñ</div></div>
          <div class="wfCard"><div class="wfTitle">Upsell</div><div class="wfMuted">–°–æ—É—Å / –Ω–∞–ø–æ—ó</div><div class="wfBtn">–î–æ–¥–∞—Ç–∏</div></div>
        </div>
        <div class="wfBtn">–î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫</div>
      </div>`;
  }
  function pagePromo(isMobile){
    return `
      ${wfHeader("–ü–æ—à—É–∫")}
      <div class="wfMain">
        ${wfHero("–ü—Ä–æ–º–æ: –•—ñ—Ç–∏","–ö–∞—Ç–∞–ª–æ–≥ –ø–æ–≤–µ—Ä—Ö –º–µ–Ω—é (ISR)")}
        ${wfCategoryGrid()}
      </div>`;
  }
  function pageSearch(isMobile){
    return `
      ${wfHeader("–ü–æ—à—É–∫")}
      <div class="wfMain">
        ${wfHero("–ü–æ—à—É–∫ –ø–æ –º–µ–Ω—é","–ü—ñ–¥–∫–∞–∑–∫–∏ (client) + —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ (SSR)")}
        <div class="wfHero"><div class="wfTitle">–ü—ñ–¥–∫–∞–∑–∫–∏</div><div class="wfMuted">—Ä–æ–ª ‚Ä¢ —Å–µ—Ç ‚Ä¢ –ª–æ—Å–æ—Å—å ‚Ä¶</div></div>
        ${wfCategoryGrid()}
      </div>`;
  }
  function pageDelivery(isMobile){
    return `
      ${wfHeader("–ú–µ–Ω—é")}
      <div class="wfMain">
        ${wfHero("–î–æ—Å—Ç–∞–≤–∫–∞ —Ç–∞ –æ–ø–ª–∞—Ç–∞","–ó–æ–Ω–∏, —Ç–∞—Ä–∏—Ñ–∏, ETA")}
        ${wfDeliveryWidget(true)}
        <div class="wfHero"><div class="wfTitle">–ó–æ–Ω–∏</div><div class="wfMuted">–ö–∞—Ä—Ç–∞/—Å–ø–∏—Å–æ–∫ –∑–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏</div></div>
        <div class="wfHero"><div class="wfTitle">–û–ø–ª–∞—Ç–∞</div><div class="wfMuted">–ö–∞—Ä—Ç–∫–∞/–≥–æ—Ç—ñ–≤–∫–∞/–æ–Ω–ª–∞–π–Ω</div></div>
      </div>`;
  }
  function pageContacts(isMobile){
    return `
      ${wfHeader("–ß–∞—Ç")}
      <div class="wfMain">
        ${wfHero("–ö–æ–Ω—Ç–∞–∫—Ç–∏ —Ñ—ñ–ª—ñ—ó","–¢–µ–ª–µ—Ñ–æ–Ω ‚Ä¢ —á–∞—Ç ‚Ä¢ –≥–æ–¥–∏–Ω–∏")}
        <div class="wfGrid">
          <div class="wfCard"><div class="wfTitle">–¢–µ–ª–µ—Ñ–æ–Ω</div><div class="wfMuted">+380 ‚Ä¶</div><div class="wfBtn">–î–∑–≤–æ–Ω–∏—Ç–∏</div></div>
          <div class="wfCard"><div class="wfTitle">–ß–∞—Ç</div><div class="wfMuted">–®–≤–∏–¥–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞</div><div class="wfBtn">–í—ñ–¥–∫—Ä–∏—Ç–∏</div></div>
        </div>
        <div class="wfHero"><div class="wfTitle">–ì–æ–¥–∏–Ω–∏</div><div class="wfMuted">10:00‚Äì22:00</div></div>
      </div>`;
  }
  function pageCart(isMobile){
    return wfCartDrawer(true);
  }
  function pageCheckout(isMobile){
    return wfCheckout(true);
  }
  function pageOrder(isMobile){
    return `
      ${wfHeader("–ü—ñ–¥—Ç—Ä–∏–º–∫–∞")}
      <div class="wfMain">
        ${wfHero("–°—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è","–¢–∞–π–º–ª–∞–π–Ω + –∫–æ–Ω—Ç–∞–∫—Ç–∏")}
        <div class="wfHero"><div class="wfTitle">–¢–∞–π–º–ª–∞–π–Ω</div><div class="wfMuted">–ü—Ä–∏–π–Ω—è—Ç–æ ‚Üí –ì–æ—Ç—É—î—Ç—å—Å—è ‚Üí –í –¥–æ—Ä–æ–∑—ñ</div></div>
        <div class="wfBtn">–ù–∞–ø–∏—Å–∞—Ç–∏ –≤ —á–∞—Ç</div>
      </div>`;
  }
  function pageLegal(isMobile){
    return `
      ${wfHeader("Legal")}
      <div class="wfMain">
        ${wfHero("–ü–æ–ª—ñ—Ç–∏–∫–∞ —Ç–∞ —É–º–æ–≤–∏","privacy ‚Ä¢ terms ‚Ä¢ cookies")}
        <div class="wfHero"><div class="wfTitle">–ù–∞–≤—ñ–≥–∞—Ü—ñ—è</div><div class="wfMuted">–õ—ñ–Ω–∫–∏ –≤ footer + –æ–∫—Ä–µ–º–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞</div></div>
      </div>`;
  }

  // States
  function stateLoadingForever(title){
    return `<div class="desktop">${wfHeader()}<div class="wfMain">${wfLoadingBlock(title)}</div></div>`;
  }
  function stateBadUndefined(label){
    return `<div class="desktop">${wfHeader()}<div class="wfMain">${wfHero(label,"–ü—Ä–∏—á–∏–Ω–∞: meta —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –∑ –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö")} ${wfMetaBad()}</div></div>`;
  }
  function stateBadEmptyNumbers(label){
    return `<div class="desktop">${wfHeader()}<div class="wfMain">${wfHero(label,"–ü—Ä–∏—á–∏–Ω–∞: —Ä–µ–Ω–¥–µ—Ä –±–µ–∑ runtime-–≤–∞–ª–∏–¥–∞—Ü—ñ—ó")} ${wfDeliveryWidget(false)}</div></div>`;
  }
  function stateOk(label){
    return `<div class="desktop">${wfHeader()}<div class="wfMain">${wfHero(label,"–ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —à–ª—è—Ö: SSR/ISR + –≤–∞–ª—ñ–¥–∞—Ü—ñ—è + fallback")} ${wfMetaGood("–ö–∏—î–≤—ñ")} ${wfDeliveryWidget(true)}</div></div>`;
  }

  // --------- UI Wiring ----------
  const nodes = Array.from(document.querySelectorAll(".node"));
  const depths = Array.from(document.querySelectorAll(".depth"));

  const dTitle = document.getElementById("dTitle");
  const dDesc = document.getElementById("dDesc");
  const dUrl = document.getElementById("dUrl");
  const dRender = document.getElementById("dRender");
  const dSeo = document.getElementById("dSeo");
  const dData = document.getElementById("dData");
  const dTodo = document.getElementById("dTodo");
  const dRoute = document.getElementById("dRoute");

  const prevDesktop = document.getElementById("prevDesktop");
  const prevMobile = document.getElementById("prevMobile");
  const dComponents = document.getElementById("dComponents");

  const stateBad = document.getElementById("stateBad");
  const stateGood = document.getElementById("stateGood");
  const stateRule = document.getElementById("stateRule");

  let showMode = "good"; // "bad" or "good"

  function setDepthsAll(show){
    depths.forEach(d => d.style.display = show ? "block" : "none");
  }

  function collapseDefault(){
    depths.forEach(d=>{
      const parent = d.getAttribute("data-children-of");
      d.style.display = (parent === "home") ? "block" : "none";
    });
  }

  function setComponents(list){
    dComponents.innerHTML = "";
    list.forEach(x=>{
      const span = document.createElement("span");
      span.className = "chip";
      span.textContent = x;
      dComponents.appendChild(span);
    });
  }

  function select(id){
    nodes.forEach(n => n.classList.toggle("active", n.dataset.id === id));
    const m = meta[id];
    const p = previews[id];
    if(!m || !p) return;

    dTitle.textContent = pTitle(id);
    dDesc.textContent = pDesc(id);
    dUrl.textContent = m.url;
    dRender.textContent = m.render;
    dSeo.textContent = m.seo;
    dData.textContent = m.data;

    dTodo.innerHTML = "";
    m.todo.forEach(x=>{
      const li = document.createElement("li");
      li.textContent = x;
      dTodo.appendChild(li);
    });
    dRoute.textContent = m.route;

    // previews
    prevDesktop.innerHTML = p.desktop();
    prevMobile.innerHTML = p.mobile();
    setComponents(p.components);

    // states
    stateBad.innerHTML = p.bad();
    stateGood.innerHTML = p.good();
    stateRule.textContent = p.rule;

    // apply current mode
    applyMode();
  }

  function pTitle(id){
    const t = {
      home:"–ì–æ–ª–æ–≤–Ω–∞",
      chooseCity:"–í–∏–±—ñ—Ä –º—ñ—Å—Ç–∞ / —Ñ—ñ–ª—ñ—ó",
      branchRoot:"–§—ñ–ª—ñ—è (–º—ñ—Å—Ç–æ/—Ä–∞–π–æ–Ω)",
      menuRoot:"–ú–µ–Ω—é (–∫–∞—Ç–∞–ª–æ–≥)",
      menuCat:"–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –º–µ–Ω—é",
      product:"–ö–∞—Ä—Ç–∫–∞ —Ç–æ–≤–∞—Ä—É",
      promoCatalog:"–ü—Ä–æ–º–æ-–≤—ñ—Ç—Ä–∏–Ω–∞",
      search:"–ü–æ—à—É–∫",
      delivery:"–î–æ—Å—Ç–∞–≤–∫–∞ —Ç–∞ –æ–ø–ª–∞—Ç–∞",
      contacts:"–ö–æ–Ω—Ç–∞–∫—Ç–∏",
      cart:"–ö–æ—à–∏–∫",
      checkout:"Checkout",
      orderStatus:"–°—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è",
      legal:"–Æ—Ä–∏–¥–∏—á–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏"
    };
    return t[id] || id;
  }
  function pDesc(id){
    const d = {
      home:"–ü—Ä–æ–º–æ + –≤–∏–±—ñ—Ä –º—ñ—Å—Ç–∞ + –ø–µ—Ä–µ—Ö–æ–¥–∏ –≤ –º–µ–Ω—é/—Ö—ñ—Ç–∏.",
      chooseCity:"–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –¥–ª—è unknown slug, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤–∏–±–æ—Ä—É —Ñ—ñ–ª—ñ—ó.",
      branchRoot:"–õ–æ–∫–∞–ª—å–Ω–∏–π —Ö–∞–± —Ñ—ñ–ª—ñ—ó: –º–µ–Ω—é, –¥–æ—Å—Ç–∞–≤–∫–∞, –∫–æ–Ω—Ç–∞–∫—Ç–∏, –≥–æ–¥–∏–Ω–∏.",
      menuRoot:"–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–∞ –ø—Ä–æ–º–æ-–∫–∞—Ç–∞–ª–æ–≥–∏ (—Ö—ñ—Ç–∏/–Ω–æ–≤–∏–Ω–∫–∏/–∞–∫—Ü—ñ—ó).",
      menuCat:"Grid —Ç–æ–≤–∞—Ä—ñ–≤ –∑ —Ñ–∞—Å–µ—Ç–∞–º–∏/—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è–º.",
      product:"SSR —Ç–æ–≤–∞—Ä—É –∑ –∞–ª–µ—Ä–≥–µ–Ω–∞–º–∏/—Å–∫–ª–∞–¥–æ–º —ñ upsell.",
      promoCatalog:"–í—ñ—Ç—Ä–∏–Ω–∞ –ø–æ–≤–µ—Ä—Ö –º–µ–Ω—é (–±–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è).",
      search:"–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ SSR, –ø—ñ–¥–∫–∞–∑–∫–∏ client, noindex.",
      delivery:"–¢–∞—Ä–∏—Ñ–∏/ETA/–∑–æ–Ω–∏ –∑ —Ü–∏—Ñ—Ä–∞–º–∏ –∞–±–æ —á–µ—Å–Ω–∏–º —Ñ–æ–ª–±–µ–∫–æ–º.",
      contacts:"–¢–µ–ª–µ—Ñ–æ–Ω/—á–∞—Ç + –¥–æ—Å—Ç—É–ø –∑ checkout.",
      cart:"Client-—Å—Ç–∞–Ω, persist, quote.",
      checkout:"Hybrid: SSR –∫–∞—Ä–∫–∞—Å + —Å—Ç–∞–Ω–∏ loading/error/retry/offline.",
      orderStatus:"Tokenized URL, —Ç–∞–π–º–ª–∞–π–Ω, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞.",
      legal:"–°—Ç–∞—Ç–∏—á–Ω—ñ SSR —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—î—é."
    };
    return d[id] || "";
  }

  // Modes: show ‚Äúbad‚Äù vs ‚Äúgood‚Äù emphasis
  function applyMode(){
    const tabs = getActiveTab();
    if(tabs === "states"){
      // always show both states in this tab
      return;
    }
    // In preview/spec tabs we simply adjust content emphasis by swapping certain blocks for some nodes.
    // Minimal: if showMode=bad, overwrite state blocks in preview for nodes where it matters.
    const activeId = document.querySelector(".node.active")?.dataset.id || "home";
    const p = previews[activeId];
    if(!p) return;

    if(showMode === "bad"){
      // preview shows "bad" key symptom overlay for relevant nodes
      const overlay = {
        chooseCity: wfMetaBad(),
        branchRoot: wfMetaBad(),
        delivery: wfDeliveryWidget(false),
        menuRoot: wfLoadingBlock("–ú–µ–Ω—é: Loading‚Ä¶"),
        menuCat: wfLoadingBlock("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: Loading‚Ä¶"),
        checkout: wfCheckout(false),
        cart: wfCartDrawer(false),
      }[activeId];

      if(overlay){
        // Inject into top of desktop preview main (quick & readable)
        const desktopEl = prevDesktop.querySelector(".wfMain");
        const mobileEl = prevMobile.querySelector(".wfMain");
        if(desktopEl) desktopEl.insertAdjacentHTML("afterbegin", `<div class="wfAlert">${overlay}</div>`);
        if(mobileEl) mobileEl.insertAdjacentHTML("afterbegin", `<div class="wfAlert">${overlay}</div>`);
      }
    } else {
      // good mode: keep clean previews (already good)
    }
  }

  // Tabs
  const tabButtons = Array.from(document.querySelectorAll("#detailTabs .tab"));
  const panels = {
    spec: document.getElementById("tab-spec"),
    preview: document.getElementById("tab-preview"),
    states: document.getElementById("tab-states"),
  };
  function getActiveTab(){
    return tabButtons.find(b => b.classList.contains("active"))?.dataset.tab || "spec";
  }
  function setTab(name){
    tabButtons.forEach(b => b.classList.toggle("active", b.dataset.tab === name));
    Object.keys(panels).forEach(k => panels[k].classList.toggle("hidden", k !== name));
  }
  tabButtons.forEach(b => b.addEventListener("click", () => setTab(b.dataset.tab)));

  // Buttons
  document.getElementById("expandAll").addEventListener("click", ()=> setDepthsAll(true));
  document.getElementById("collapseAll").addEventListener("click", ()=> collapseDefault());
  document.getElementById("focusCatalog").addEventListener("click", ()=>{
    depths.forEach(d=>{
      const parent = d.getAttribute("data-children-of");
      if(parent === "home" || parent === "branchRoot" || parent === "menuRoot") d.style.display="block";
    });
    select("menuCat");
    setTab("preview");
  });
  document.getElementById("focusCheckout").addEventListener("click", ()=>{
    depths.forEach(d=>{
      const parent = d.getAttribute("data-children-of");
      if(parent === "home") d.style.display="block";
      if(parent === "branchRoot") d.style.display="block";
    });
    select("checkout");
    setTab("states");
  });
  document.getElementById("showBad").addEventListener("click", ()=>{
    showMode="bad";
    // re-render selected node to re-apply mode
    const activeId = document.querySelector(".node.active")?.dataset.id || "home";
    select(activeId);
  });
  document.getElementById("showGood").addEventListener("click", ()=>{
    showMode="good";
    const activeId = document.querySelector(".node.active")?.dataset.id || "home";
    select(activeId);
  });

  // Side nav
  const sideLinks = Array.from(document.querySelectorAll("#sideNav a"));
  sideLinks.forEach(a=>{
    a.addEventListener("click", (e)=>{
      e.preventDefault();
      sideLinks.forEach(x=>x.classList.remove("active"));
      a.classList.add("active");
      const id = a.getAttribute("data-jump");
      const el = document.getElementById(id);
      if(el) el.scrollIntoView({behavior:"smooth", block:"start"});
    });
  });

  // Node click
  nodes.forEach(n=> n.addEventListener("click", ()=> {
    select(n.dataset.id);
    setTab("spec");
  }));

  // Init
  collapseDefault();
  select("home");
  setTab("spec");
</script>
</body>
</html>
